rule powershell_encoded_malware
{
    meta:
        author = "Vaishnavi Reddy"
        description = "Detects suspicious PowerShell encoded commands"
        date = "2025-11-26"
    
    strings:
        $a = "powershell -enc"
        $b = "Invoke-Expression"
        $c = "Base64"
    
    condition:
        any of ($a,$b,$c)
}

rule generic_keylogger
{
    meta:
        author = "Vaishnavi Reddy"
        description = "Detects common keylogger indicators"
        date = "2025-11-26"
    
    strings:
        $a = "GetAsyncKeyState"
        $b = "SetWindowsHookEx"
        $c = "keylog.txt"
        $d = "Keylogger started"
    
    condition:
        any of ($a,$b,$c,$d)
}

rule suspicious_network_malware
{
    meta:
        author = "Vaishnavi Reddy"
        description = "Detects suspicious command and control patterns"
        date = "2025-11-26"
    
    strings:
        $a = "http://"
        $b = "cmd.exe /c"
        $c = ":4444"
        $d = "reverse shell"
    
    condition:
        2 of ($a,$b,$c,$d)
}
rule eicar_test_file
{
    meta:
        author = "Vaishnavi Reddy"
        description = "Detects EICAR antivirus test string"
        date = "2025-11-26"
    
    strings:
        $eicar = "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!"
    
    condition:
        $eicar
}
rule ransomware_note
{
    meta:
        author = "Vaishnavi Reddy"
        description = "Detects ransomware style ransom note text"
        date = "2025-11-27"

    strings:
        $a = "encrypted"
        $b = "BTC"
        $c = "decrypt"
        $d = "Send"
        $e = "wallet"

    condition:
        any of ($a,$b,$c,$d,$e)
}
rule trojan_payload_indicator
{
    meta:
        author = "Vaishnavi Reddy"
        description = "Detects dummy trojan payload keywords"
        date = "2025-11-27"

    strings:
        $a = "exec_payload"
        $b = "steal_data"
        $c = "C2_server_connect"
        $d = "njRAT"
        $e = "clientID"

    condition:
        any of ($a,$b,$c,$d,$e)
}
